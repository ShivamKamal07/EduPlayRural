{% extends "shared/base.html" %}
{% block title %}Chemistry Lesson 6{% endblock %}
{% block content %}
<style>
body {
    font-family: Arial, sans-serif;
    background: #f3e5f5;
    display: flex;
    justify-content: center;
    padding: 20px;
}
.game-container {
    background: #ffffff;
    padding: 25px;
    border-radius: 15px;
    box-shadow: 0px 5px 20px rgba(0,0,0,0.1);
    max-width: 600px;
    width: 100%;
    text-align: center;
}
h1 {
    color: #6a1b9a;
}
button {
    margin: 5px;
    padding: 10px 20px;
    font-size: 16px;
    border-radius: 8px;
    border: none;
    cursor: pointer;
    background-color: #8e24aa;
    color: white;
    transition: 0.3s;
}
button:hover {
    background-color: #6a1b9a;
}
.options button {
    display: block;
    width: 80%;
    margin: 10px auto;
    background-color: #ba68c8;
}
.options button:hover {
    background-color: #ab47bc;
}
#message {
    font-size: 18px;
    margin: 10px 0;
    color: #d32f2f;
}
.intro {
    font-size: 16px;
    margin-bottom: 20px;
    color: #6a1b9a;
}
.lab-image {
    width: 150px;
    margin: 10px auto;
    display: block;
}
</style>

<div class="game-container">
    <h1>Chemistry Lab Game</h1>
    <div id="level-info">Introduction</div>
    <div id="question">
        <div class="intro">
            Welcome to the Virtual Chemistry Lab! <br>
            Simulate basic experiments and test your knowledge. <br>
            Press Start to begin!
        </div>
    </div>
    <div class="options" id="options"></div>
    <div id="message"></div>
    <div>
        <button id="startBtn">Start</button>
        <button id="stopBtn">Stop</button>
        <button id="nextBtn">Next Level</button>
        <button id="backBtn">Back</button>
    </div>
</div>

<script>
const quizData = [
    [
        {question: "Which safety equipment must be worn in lab?", options: ["Goggles", "Sunglasses", "Hat", "Gloves only"], answer: "Goggles"},
        {question: "Which is used to measure liquid volume?", options: ["Beaker", "Measuring Cylinder", "Pipette", "Bunsen Burner"], answer: "Measuring Cylinder"}
    ],
    [
        {question: "Mixing vinegar and baking soda produces?", options: ["CO2 Gas", "O2 Gas", "H2 Gas", "H2O only"], answer: "CO2 Gas"},
        {question: "Adding indicator to acid turns it?", options: ["Red", "Blue", "Green", "Yellow"], answer: "Red"}
    ],
    [
        {question: "Metal reacting with acid produces?", options: ["Hydrogen Gas", "Oxygen Gas", "Carbon Dioxide", "Nitrogen Gas"], answer: "Hydrogen Gas"},
        {question: "Combustion in lab produces?", options: ["Heat and Light", "Water only", "Salt", "Nothing"], answer: "Heat and Light"}
    ]
];

let currentLevel = -1;
let currentQuestion = 0;
let score = 0;
let gameStarted = false;

const questionEl = document.getElementById("question");
const optionsEl = document.getElementById("options");
const messageEl = document.getElementById("message");
const levelInfoEl = document.getElementById("level-info");

document.getElementById("startBtn").addEventListener("click", startGame);
document.getElementById("stopBtn").addEventListener("click", stopGame);
document.getElementById("nextBtn").addEventListener("click", nextLevel);
document.getElementById("backBtn").addEventListener("click", previousLevel);

function startGame() {
    if (currentLevel === -1) currentLevel = 0;
    gameStarted = true;
    currentQuestion = 0;
    score = 0;
    showQuestion();
    messageEl.textContent = "";
}

function stopGame() {
    gameStarted = false;
    questionEl.innerHTML = "<div class='intro'>Game stopped. Press Start to play again.</div>";
    optionsEl.innerHTML = "";
    messageEl.textContent = `Your score: ${score}`;
}

function showQuestion() {
    if (!gameStarted) return;

    const questionData = quizData[currentLevel][currentQuestion];
    questionEl.textContent = questionData.question;
    optionsEl.innerHTML = "";
    questionData.options.forEach(option => {
        const btn = document.createElement("button");
        btn.textContent = option;
        btn.addEventListener("click", () => checkAnswer(option));
        optionsEl.appendChild(btn);
    });
    levelInfoEl.textContent = "Level " + (currentLevel + 1);
}

function checkAnswer(selected) {
    const questionData = quizData[currentLevel][currentQuestion];
    if (selected === questionData.answer) {
        messageEl.textContent = "Correct!";
        score++;
    } else {
        messageEl.textContent = "Wrong! Correct answer: " + questionData.answer;
    }
    currentQuestion++;
    if (currentQuestion < quizData[currentLevel].length) {
        setTimeout(showQuestion, 1000);
    } else {
        messageEl.textContent += ` Level completed! Score: ${score}`;
        optionsEl.innerHTML = "";
    }
}

function nextLevel() {
    if (currentLevel < quizData.length - 1) {
        currentLevel++;
        startGame();
    } else {
        messageEl.textContent = "No more levels!";
    }
}

function previousLevel() {
    if (currentLevel > 0) {
        currentLevel--;
        startGame();
    } else {
        currentLevel = -1;
        questionEl.innerHTML = `<div class="intro">
            Welcome to the Virtual Chemistry Lab! <br>
            Simulate basic experiments and test your knowledge. <br>
            Press Start to begin!
        </div>`;
        optionsEl.innerHTML = "";
        messageEl.textContent = "";
        levelInfoEl.textContent = "Introduction";
    }
}
</script>
{% endblock %}
